<template>
    <div>
        <van-cell-group title="åŸºç¡€æ–¹æ³•æµ‹è¯•">
            <van-row type="flex" justify="center">
                <van-button type="info" @click="testSleep" style="margin: 8px;">æµ‹è¯• sleep (2ç§’)</van-button>
            </van-row>
            <van-row type="flex" justify="center">
                <van-button type="warning" @click="testToast" style="margin: 8px;">æµ‹è¯• toast</van-button>
            </van-row>
            <van-row type="flex" justify="center">
                <van-button @click="testToastLog" style="margin: 8px;">æµ‹è¯• toastLog</van-button>
            </van-row>
            <van-row type="flex" justify="center">
                <van-button @click="testRandom" style="margin: 8px;">æµ‹è¯• random</van-button>
            </van-row>
        </van-cell-group>
        
        <van-cell-group title="ç³»ç»Ÿä¿¡æ¯æµ‹è¯•">
            <van-row type="flex" justify="center">
                <van-button @click="testCurrentInfo" style="margin: 8px;">è·å–å½“å‰åŒ…å/Activity</van-button>
            </van-row>
            <van-row type="flex" justify="center">
                <van-button @click="testClipboard" style="margin: 8px;">æµ‹è¯•å‰ªè´´æ¿</van-button>
            </van-row>
            <van-row type="flex" justify="center">
                <van-button @click="testScreenSize" style="margin: 8px;">è·å–å±å¹•å°ºå¯¸</van-button>
            </van-row>
        </van-cell-group>
        
        <van-cell-group title="ç±»å‹åˆ¤æ–­æµ‹è¯•">
            <van-row type="flex" justify="center">
                <van-button @click="testSpecies" style="margin: 8px;">æµ‹è¯• species</van-button>
            </van-row>
            <van-row type="flex" justify="center">
                <van-button @click="testTypeCheckers" style="margin: 8px;">æµ‹è¯•ç±»å‹åˆ¤æ–­æ–¹æ³•</van-button>
            </van-row>
        </van-cell-group>
        
        <van-cell-group title="ç­‰å¾…æ–¹æ³•æµ‹è¯•">
            <van-row type="flex" justify="center">
                <van-button @click="testWait" style="margin: 8px;">æµ‹è¯• wait å‡½æ•°</van-button>
            </van-row>
        </van-cell-group>
        
        <van-cell-group title="åæ ‡æ ‡åº¦æµ‹è¯•">
            <van-row type="flex" justify="center">
                <van-button @click="testCoordinateScale" style="margin: 8px;">æµ‹è¯•åæ ‡æ ‡åº¦</van-button>
            </van-row>
        </van-cell-group>
    </div>
</template>

<script>
export default {
    name: 'GlobalTest',
    methods: {
        // ==================== åŸºç¡€æ–¹æ³•æµ‹è¯• ====================
        
        // æµ‹è¯• sleep
        async testSleep() {
            richauto.global.toastLog('å¼€å§‹æµ‹è¯• sleep...');
            const startTime = Date.now();
            
            await richauto.global.sleep(2000);
            
            const elapsed = Date.now() - startTime;
            richauto.global.toastLog(`sleep å®Œæˆï¼å®é™…è€—æ—¶: ${elapsed}ms`);
        },
        
        // æµ‹è¯• toast
        testToast() {
            richauto.global.toast('Hello from richauto.global.toast()! ğŸ‰');
        },
        
        // æµ‹è¯• toastLog
        testToastLog() {
            richauto.global.toastLog('è¿™æ˜¯ä¸€æ¡ toastLog æ¶ˆæ¯ï¼ŒåŒæ—¶ä¼šæ‰“å°åˆ°æ—¥å¿—');
        },
        
        // æµ‹è¯• random
        async testRandom() {
            const randomValue1 = await richauto.global.random();
            const randomValue2 = await richauto.global.random(1, 100);
            richauto.global.toastLog(`éšæœºæ•°:\næ— å‚: ${randomValue1.toFixed(4)}\n[1-100]: ${randomValue2}`);
        },
        
        // ==================== ç³»ç»Ÿä¿¡æ¯æµ‹è¯• ====================
        
        // æµ‹è¯•è·å–å½“å‰åŒ…åå’ŒActivity
        async testCurrentInfo() {
            const pkg = await richauto.global.currentPackage();
            const act = await richauto.global.currentActivity();
            richauto.global.toastLog(`å½“å‰åŒ…å: ${pkg}\nå½“å‰Activity: ${act}`);
        },
        
        // æµ‹è¯•å‰ªè´´æ¿
        async testClipboard() {
            await richauto.global.setClip('æµ‹è¯•å‰ªè´´æ¿å†…å®¹ - AutoJS6');
            const clipContent = await richauto.global.getClip();
            richauto.global.toastLog(`å‰ªè´´æ¿å†…å®¹: ${clipContent}`);
        },
        
        // æµ‹è¯•å±å¹•å°ºå¯¸
        async testScreenSize() {
            const width = await richauto.global.WIDTH;
            const height = await richauto.global.HEIGHT;
            richauto.global.toastLog(`å±å¹•å°ºå¯¸:\nå®½åº¦: ${width}px\né«˜åº¦: ${height}px`);
        },
        
        // ==================== ç±»å‹åˆ¤æ–­æµ‹è¯• ====================
        
        // æµ‹è¯• species ç±»å‹åˆ¤æ–­
        async testSpecies() {
            const testData = [
                { value: 'hello', label: 'å­—ç¬¦ä¸²' },
                { value: 123, label: 'æ•°å­—' },
                { value: true, label: 'å¸ƒå°”å€¼' },
                { value: [1, 2, 3], label: 'æ•°ç»„' },
                { value: { a: 1 }, label: 'å¯¹è±¡' },
                { value: null, label: 'null' },
                { value: undefined, label: 'undefined' },
            ];
            
            let result = 'ç±»å‹åˆ¤æ–­æµ‹è¯•:\n';
            for (const item of testData) {
                const type = await richauto.global.species(item.value);
                result += `${item.label}: ${type}\n`;
            }
            
            richauto.global.toastLog(result);
        },
        
        // æµ‹è¯•ç±»å‹åˆ¤æ–­æ–¹æ³•
        async testTypeCheckers() {
            const testData = [
                'hello',
                123,
                true,
                [1, 2, 3],
                { a: 1 },
                null,
                undefined,
                new Date(),
                /regex/,
            ];
            
            let result = 'ç±»å‹åˆ¤æ–­æ–¹æ³•æµ‹è¯•:\n';
            
            for (const item of testData) {
                const isString = await richauto.global.isString(item);
                const isNumber = await richauto.global.isNumber(item);
                const isArray = await richauto.global.isArray(item);
                const isObject = await richauto.global.isObject(item);
                
                if (isString) result += `"${item}" æ˜¯å­—ç¬¦ä¸²\n`;
                else if (isNumber) result += `${item} æ˜¯æ•°å­—\n`;
                else if (isArray) result += `${JSON.stringify(item)} æ˜¯æ•°ç»„\n`;
                else if (isObject) result += `${JSON.stringify(item)} æ˜¯å¯¹è±¡\n`;
            }
            
            richauto.global.toastLog(result);
        },
        
        // ==================== ç­‰å¾…æ–¹æ³•æµ‹è¯• ====================
        
        // æµ‹è¯• wait å‡½æ•°
        async testWait() {
            richauto.global.toastLog('å¼€å§‹æµ‹è¯• wait å‡½æ•°...');
            
            let counter = 0;
            const condition = () => {
                counter++;
                return counter >= 3;
            };
            
            const result = await richauto.global.wait(condition, 100);
            richauto.global.toastLog(`wait å®Œæˆï¼æ¡ä»¶æ»¡è¶³ï¼Œæ£€æŸ¥äº† ${counter} æ¬¡`);
        },
        
        // ==================== åæ ‡æ ‡åº¦æµ‹è¯• ====================
        
        // æµ‹è¯•åæ ‡æ ‡åº¦
        async testCoordinateScale() {
            // å‡è®¾è®¾è®¡å°ºå¯¸ä¸º 1080x1920
            const designWidth = 1080;
            const designHeight = 1920;
            const designX = 540;  // è®¾è®¡å›¾ä¸­çš„ X åæ ‡
            const designY = 960;  // è®¾è®¡å›¾ä¸­çš„ Y åæ ‡
            
            // è·å–å®é™…åæ ‡
            const actualX = await richauto.global.cX(designX, designWidth);
            const actualY = await richauto.global.cY(designY, designHeight);
            const actualYx = await richauto.global.cYx(designY, designWidth);
            const actualXy = await richauto.global.cXy(designX, designHeight);
            
            richauto.global.toastLog(
                `åæ ‡æ ‡åº¦æµ‹è¯•:\n` +
                `è®¾è®¡åæ ‡: (${designX}, ${designY})\n` +
                `cX: ${actualX}\n` +
                `cY: ${actualY}\n` +
                `cYx: ${actualYx}\n` +
                `cXy: ${actualXy}`
            );
        },
    }
};
</script>

